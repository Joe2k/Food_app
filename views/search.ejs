<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Buy</title>
    <link rel="stylesheet" href="/menu_assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i">
    <link rel="stylesheet" href="/menu_assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="/menu_assets/css/Sidebar-Cool-SB-Admin-Inspirate.css">
    <link rel="stylesheet" href="/menu_assets/css/untitled.css">
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>

<nav class="navbar navbar-dark navbar-expand-lg fixed-top bg-dark navbar-custom" style="color: rgb(194,74,74);background-color: rgb(255,255,255);">
    <div class="container"><a class="navbar-brand" href="/home">FOoD</a><button data-toggle="collapse" class="navbar-toggler" data-target="#navbarResponsive"><span class="navbar-toggler-icon"></span></button>
        <div class="collapse navbar-collapse" id="navbarResponsive" style="color: rgb(242,0,0);">
            <ul class="nav navbar-nav ml-auto">
                <li class="nav-item" role="presentation"><a class="nav-link" href="/home">Home</a></li>
                <li class="nav-item" role="presentation"><a class="nav-link" href="/buy">Shop</a></li>
                <li class="nav-item" role="presentation"><a class="nav-link" href="/menu/starters">Starters</a></li>
                <li class="nav-item" role="presentation"><a class="nav-link" href="/menu/mains" >Main Course</a></li>
                <li class="nav-item" role="presentation"><a class="nav-link" href="/menu/deserts">Deserts</a></li>
            </ul>
        </div>
    </div>
</nav>

<header class="masthead text-center text-white">
    <div class="masthead-content">
        <div class="container">
            <h1 class="masthead-heading mb-0" style="border-style: none; display: block; padding-bottom: 30px;">Search Results</h1>

        </div>
    </div>
    <div class="bg-circle-1 bg-circle"></div>
    <div class="bg-circle-2 bg-circle"></div>

    <div class="bg-circle-3 bg-circle"></div>

</header>

<section style="padding-bottom: 50px">
    <div class="container">
        <div class="row">
            <%if(docs1.length===0 && docs2.length===0){%>
                <h1 class="text-center col-sm-12">Sorry :(</h1>
                <h4 class="text-center col-sm-12">No items found</h4>
                <form style="margin-right: auto;margin-left: auto;padding: 0px 30px 20px;" method="get" action="/buy">
                    <button type="submit" class="btn btn-primary">Take me Back</button>
                </form>
            <%}%>

                <%if(docs1.length!=0 || docs2.length!=0){%>
                <%docs1.forEach(function (doc){%>
                <div class="col-lg-4 ">
                    <div class="p-5"><img class="img-fluid border rounded-circle border-primary shadow-lg" src="<%=doc.img%>" style="box-shadow: 0px 0px;">
                        <h2 style="text-align: center;padding: 20px 10px 0px;margin: 0px 0px 0px;"><%=doc.name%></h2>
                        <p style="text-align: center;"><%=doc.discription%></p>
                        <h4 style="text-align: center;">Sold By <%=doc.by%></h4>
                        <h5 style="text-align: center;">Price: Rs. <%=doc.price%></h5>
                        <form class="text-center">
                            <button name="button" value="<%=doc.price%>" class="btn btn-primary plus-btn" type="button" style="border-radius: 20px;"><i class="fa fa-plus"></i></button>
                            <input name="<%=doc.name%>" type="text" style="text-align: center;width: 60px;border-radius: 200px;border-style: solid;border-color: rgb(238,9,121);margin: 10px;">
                            <button name="button" value="<%=doc.price%>" class="btn btn-primary minus-btn" type="button" style="border-radius: 20px;"><i class="fa fa-minus"></i></button>
                        </form>
                    </div>
                </div>
                <%})%>
                <%docs2.forEach(function (doc){%>
                <div class="col-lg-4 ">
                    <div class="p-5"><img class="img-fluid border rounded-circle border-primary shadow-lg" src="<%=doc.img%>" style="box-shadow: 0px 0px;">
                        <h2 style="text-align: center;padding: 20px 10px 0px;margin: 0px 0px 0px;"><%=doc.name%></h2>
                        <p style="text-align: center;"><%=doc.discription%></p>
                        <h4 style="text-align: center;">Sold By <%=doc.by%></h4>
                        <h5 style="text-align: center;">Price: Rs. <%=doc.price%></h5>
                        <form class="text-center">
                            <button name="button" value="<%=doc.price%>" class="btn btn-primary plus-btn" type="button" style="border-radius: 20px;"><i class="fa fa-plus"></i></button>
                            <input name="<%=doc.name%>" type="text" style="text-align: center;width: 60px;border-radius: 200px;border-style: solid;border-color: rgb(238,9,121);margin: 10px;">
                            <button name="button" value="<%=doc.price%>" class="btn btn-primary minus-btn" type="button" style="border-radius: 20px;"><i class="fa fa-minus"></i></button>
                        </form>
                    </div>
                </div>
                <%})%>
                <form style="margin-right: auto;margin-left: auto;padding: 0px 30px 20px;" method="get" action="/buy">
                    <button type="submit" class="btn btn-primary">Take me Back</button>
                </form>
                <%}%>
        </div>
    </div>
</section>

<div class="footer">
    <span id="before">Total : Rs </span>
    <span class="total"></span>
    <form method="post" action="/cart/in">
    <%docs.forEach(function (item) {%>
    <input  type="hidden" class="hidden" name="<%=item.name%>" value="">
    <%})%>
    <button type="submit"  class="btn btn-outline-primary" id="cart">Cart</button>
    </form>
</div>



<footer class="text-center">Made by Jonathan</footer>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
<script type="text/javascript">
    $(document).on('click','.navbar-collapse',function(e) {
        if( $(e.target).is('a') ) {
            $(this).collapse('hide');
        }
    });

    $(document).ready(function () {

        if(!sessionStorage.getItem("total"))
        {
            sessionStorage.setItem("total","0");
        }
        let total2=parseInt(sessionStorage.getItem("total"));
        $(".total").text(total2);

        var allInputs = $( ":input" );
        for(var i=0;i<allInputs.length;i++)
        {
            if(allInputs[i].name!="button") {
                //console.log(allInputs[i].name, allInputs[i].value);
                if(!sessionStorage.getItem(allInputs[i].name))
                {
                    sessionStorage.setItem(allInputs[i].name,"0");
                }
                //allInputs[i].val(parseInt(sessionStorage.getItem(allInputs[i].name)));
                let name1=allInputs[i].name;
                let newNum=parseInt(sessionStorage.getItem(allInputs[i].name));
                //console.log(allInputs);

                $(allInputs[i])[0].value=newNum;


            }
        }
    });

    $('.minus-btn').on('click', function(e) {

        e.preventDefault();
        var $this = $(this);
        var $input = $this.closest('div').find('input');
        console.log($this);
        var value = parseInt($input.val());
        let total1= parseInt(sessionStorage.getItem("total"));
        if(value>0)
        {
            total1=total1-parseInt($this[0].value);
            if(total1<0)
                total1=0;
            $(".total").text(total1);
            sessionStorage.setItem("total",total1);
        }
        if (value >= 1) {
            value = value - 1;
        } else {
            value = 0;
        }
        sessionStorage.setItem($input[0].name,value);


        $input.val(value);
        var allInputs = $( ":input" );
        for(var i=0;i<allInputs.length;i++)
        {
            if(allInputs[i].name!="button") {
                //console.log(allInputs[i].name, allInputs[i].value);
                if(!sessionStorage.getItem(allInputs[i].name))
                {
                    sessionStorage.setItem(allInputs[i].name,"0");
                }
                //allInputs[i].val(parseInt(sessionStorage.getItem(allInputs[i].name)));
                let name1=allInputs[i].name;
                let newNum=parseInt(sessionStorage.getItem(allInputs[i].name));
                //console.log(allInputs);

                $(allInputs[i])[0].value=newNum;


            }
        }

    });

    $('.plus-btn').on('click', function(e) {
        e.preventDefault();
        var $this = $(this);
        var $input = $this.closest('div').find('input');
        var value = parseInt($input[0].value);
        let total1= parseInt(sessionStorage.getItem("total"));

        if (value <= 100) {
            value = value + 1;
        } else {
            value =100;
        }
        sessionStorage.setItem($input[0].name,value);

        $input.val(value);

        total1=total1+parseInt($this[0].value);
        $(".total").text(total1);
        sessionStorage.setItem("total",total1);
        var allInputs = $( ":input" );
        for(var i=0;i<allInputs.length;i++)
        {
            if(allInputs[i].name!="button") {
                //console.log(allInputs[i].name, allInputs[i].value);
                if(!sessionStorage.getItem(allInputs[i].name))
                {
                    sessionStorage.setItem(allInputs[i].name,"0");
                }
                //allInputs[i].val(parseInt(sessionStorage.getItem(allInputs[i].name)));
                let name1=allInputs[i].name;
                let newNum=parseInt(sessionStorage.getItem(allInputs[i].name));
                //console.log(allInputs);

                $(allInputs[i])[0].value=newNum;


            }
        }
    });
</script>
</body>
</html>